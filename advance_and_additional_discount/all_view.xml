<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data>
    
    	<record id="view_order_ext" model="ir.ui.view">
            <field name="name">sale.order.form.ext</field>
            <field name="model">sale.order</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <data>
					<xpath expr="/form/header/button[@name='%(sale.action_view_sale_advance_payment_inv)d']" position="attributes">
						<attribute name="attrs">{'invisible': ['|','|',('state', 'not in', ('progress')),('advance_type', '=', False),('num_invoice', '&gt;', 0)]}</attribute>
						<attribute name="context">{'advance_type':advance_type}</attribute>
					</xpath>
	                <field name="amount_untaxed" position="after">
	                    <field name="add_disc" colspan="2"/>
	                    <field name="add_disc_amt" colspan="2" widget="monetary" options="{'currency_field': 'currency_id'}"/>
	                    <field name="amount_net" sum="Net Amount" colspan="2" widget="monetary" options="{'currency_field': 'currency_id'}"/>
					</field>
					<xpath expr="/form/sheet/notebook/page[@string='Other Information']/group" position="inside">
	                    <group>
	                        <field name="advance_type" attrs="{'invisible': [('order_policy', 'not in', ('picking','manual'))]}"/>
							<field name="amount_deposit" attrs="{'invisible': [('order_policy', 'not in', ('picking','manual'))]}"/>
							<field name="advance_percentage" readonly="True" attrs="{'invisible': [('order_policy', 'not in', ('picking','manual'))]}"/>
	                        <field name="num_invoice" attrs="{'invisible': [('order_policy', 'not in', ('picking','manual'))]}"/>                   
						</group>
					</xpath> 				
				</data> 
            </field>
       </record>
    	
       <record id="purchase_order_form_ext" model="ir.ui.view">
            <field name="name">purchase.order.form.ext</field>
            <field name="model">purchase.order</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
				<xpath expr="/form/header/button[@name='view_invoice']" position="after">
                    <button name="%(action_view_purchase_advance_payment_inv)d" string="Receive Advance Invoice"
                    	attrs="{'invisible': ['|','|',('state', 'not in', ('approved')),('advance_type', '=', False),('num_invoice', '&gt;', 0)]}"
                        type="action" class="oe_highlight" groups="base.group_user"
                    	context="{'advance_type':advance_type}"/>
				</xpath>                
				<field name="amount_untaxed" position="after">
                    <field name="add_disc" colspan="2"/>
                    <field name="add_disc_amt" colspan="2" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_net" sum="Net Amount" colspan="2" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                </field>  
				<xpath expr="/form/sheet/notebook/page[@string='Incoming Shipments &amp; Invoices']/group" position="inside">
                    <group>
                        <field name="advance_type" />
						<field name="amount_deposit" />
						<field name="advance_percentage" readonly="True" />
                        <field name="num_invoice" />                   
					</group>
				</xpath> 
            </field>
        </record>
        
        
        <record id="invoice_form_ext" model="ir.ui.view">
            <field name="name">account.invoice.form.ext</field>
            <field name="model">account.invoice</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.invoice_form"/>
            <field name="arch" type="xml">
                <field name="amount_untaxed" position="after">
                  	<field name="add_disc" />
                	<field name="add_disc_amt"  widget="monetary" options="{'currency_field': 'currency_id'}"/>
                	<field name="amount_net" sum="Net Amount" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_advance" sum="Advance Amt" colspan="2" attrs="{'invisible':[('amount_advance', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_deposit" sum="Deposit Amt" colspan="2" attrs="{'invisible':[('amount_deposit', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_beforetax" sum="Before Taxes" colspan="2" attrs="{'invisible':[('amount_advance', '=', 0.0),('amount_deposit', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                </field>
            </field>
        </record>
        
        <record id="invoice_supplier_form_ext" model="ir.ui.view">
            <field name="name">account.invoice.supplier.form.ext</field>
            <field name="model">account.invoice</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.invoice_supplier_form"/>
            <field name="priority">2</field>
            <field name="arch" type="xml">
                <field name="amount_untaxed" position="after">
                  <field name="add_disc" />
                	<field name="add_disc_amt"  widget="monetary" options="{'currency_field': 'currency_id'}"/>
                	<field name="amount_net" sum="Net Amount" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_advance" sum="Advance Amt" colspan="2" attrs="{'invisible':[('amount_advance', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_deposit" sum="Deposit Amt" colspan="2" attrs="{'invisible':[('amount_deposit', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="amount_beforetax" sum="Before Taxes" colspan="2" attrs="{'invisible':[('amount_advance', '=', 0.0),('amount_deposit', '=', 0.0)]}" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                </field>
            </field>
        </record>
        
    </data>
</openerp>
